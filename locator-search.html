<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="stylesheet" type="text/css" href="css/style.css">
  <link rel="icon" href="favicon.png" type="image/x-icon" />

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="manifest" href="/images/site.webmanifest">

  <title>Project name - Page</title>
  <meta name="description" content="">
</head>

<body>
  <div class="loader-component">
    <div class="loader-image"></div>
  </div>

  <!--Modals-->
  <!--end-->

  <header class=""></header>

  <main class="page">
      <section class="container-fluid">
          <div class="row">
              <div class="col-md-5 bg-gray px-50 pt-150">
                  <div class="row mb-30">
                        <div class="col ">
                            <svg class="icon-bar align-middle mr-5" aria-hidden="true"><use href="#icon-bar" xlink:href="#icon-bar"></use></svg>
                            Restaurants/Bars
                        </div>
                        <div class="col ">
                            <svg class="icon-bar align-middle mr-5" aria-hidden="true"><use href="#icon-bar" xlink:href="#icon-bar"></use></svg>
                          Stores
                        </div>
                  </div>

                  <form action="" class="form-map">
                    <div class="input-group">
                        <input type="text" placeholder="Please enter state, city, or zip code">
                        <button>
                            <svg class="icon-search" aria-hidden="true"><use href="#icon-search" xlink:href="#icon-search"></use></svg>
                        </button>
                    </div>
                  </form>

                  <div class="sucursales">
                      <div>
                          <div class="loc rest" id="FANCYFREELIQUOR" data-cat="bar" data-url="google.com">
                              <div class="d-flex">
                                  <div class="pr-15">
                                      <div class="loc-pic">
                                          <svg class="icon-bar" aria-hidden="true"><use href="#icon-bar" xlink:href="#icon-bar"></use></svg>
                                      </div>
                                  </div>
                                  <div class="">
                                      <h3 class="loc-link pb-5">FANCY FREE LIQUOR</h3>
                                      <div class="loc-address pt-5">2001 W Burbank Blvd, Burbank, CA 91506, USA</div>
                                  </div>
                              </div>
                          </div>

                          <div class="loc rest" id="FANCYFREELIQUOR2" data-cat="suc" data-url="google.com">
                            <div class="d-flex">
                                <div class="pr-15">
                                    <div class="loc-pic">
                                        <svg class="icon-bar" aria-hidden="true"><use href="#icon-bar" xlink:href="#icon-bar"></use></svg>
                                    </div>
                                </div>
                                <div class="">
                                    <h3 class="loc-link pb-5">FANCY FREE LIQUOR 2</h3>
                                    <div class="loc-address pt-5">260 South La Brea Ave, LA, CA 90036, USA</div>
                                </div>
                            </div>
                        </div>
                      </div>
                  </div>
              </div>

              <div class="col">
                <div class="location-map" id="google-maps"></div>
              </div>
          </div>
          
      </section>
  </main>

  <div id="svg"></div>

  <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
  
  <!-- JS libs -->
  
  <!-- start: interactions -->
  <script src="js/libs/swiper.min.js"></script>
  <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
  <script src="js/libs/basicScroll.js"></script>
  <script src="js/libs/tweenMax.min.js"></script>
  <!-- end: interactions -->
  
  <!-- main js -->
  <script src="js/app.js"></script>
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCzMqrM4cxU_5IIV0fwN-bCgPwHP-uEGoc"></script>
  <script>

		var map = new google.maps.Map(document.getElementById('google-maps'), {
				zoom: 5,
				center: {lat: 38.8327349, lng: -100.4349274}
			});
		    var styles = [

                {

                "elementType": "geometry",

                "stylers": [

                    {

                    "color": "#f5f4f0"

                    }

                ]

                },

                {

                "elementType": "labels.icon",

                "stylers": [

                    {

                    "visibility": "off"

                    }

                ]

                },

                {

                "elementType": "labels.text.fill",

                "stylers": [

                    {

                    "color": "#616161"

                    },

                    {

                    "visibility": "off"

                    }

                ]

                },

                {

                "elementType": "labels.text.stroke",

                "stylers": [

                    {

                    "color": "#f5f5f5"

                    }

                ]

                },

                {

                "featureType": "administrative.land_parcel",

                "elementType": "labels.text.fill",

                "stylers": [

                    {

                    "color": "#bdbdbd"

                    },

                    {

                    "visibility": "off"

                    }

                ]

                },

                {

                "featureType": "poi",

                "elementType": "geometry",

                "stylers": [

                    {

                    "color": "#e7e5dd"

                    }

                ]

                },

                {

                "featureType": "poi",

                "elementType": "labels.text.fill",

                "stylers": [

                    {

                    "color": "#757575"

                    },

                    {

                    "visibility": "off"

                    }

                ]

                },

                {

                "featureType": "poi.park",

                "elementType": "geometry",

                "stylers": [

                    {

                    "color": "#e7e5dd"

                    },

                    {

                    "visibility": "off"

                    }

                ]

                },

                {

                "featureType": "poi.park",

                "elementType": "labels.text.fill",

                "stylers": [

                    {

                    "color": "#9e9e9e"

                    },

                    {

                    "visibility": "off"

                    }

                ]

                },

                {

                "featureType": "road",

                "elementType": "geometry",

                "stylers": [

                    {

                    "color": "#ffffff"

                    }

                ]

                },

                {

                "featureType": "road.arterial",

                "elementType": "labels.text.fill",

                "stylers": [

                    {

                    "color": "#757575"

                    },

                    {

                    "visibility": "off"

                    }

                ]

                },

                {

                "featureType": "road.highway",

                "elementType": "geometry",

                "stylers": [

                    {

                    "color": "#e7e5dd"

                    }

                ]

                },

                {

                "featureType": "road.highway",

                "elementType": "labels.text.fill",

                "stylers": [

                    {

                    "color": "#616161"

                    },

                    {

                    "visibility": "off"

                    }

                ]

                },

                {

                "featureType": "road.local",

                "elementType": "labels.text.fill",

                "stylers": [

                    {

                    "color": "#9e9e9e"

                    },

                    {

                    "visibility": "off"

                    }

                ]

                },

                {

                "featureType": "transit.line",

                "elementType": "geometry",

                "stylers": [

                    {

                    "color": "#e5e5e5"

                    }

                ]

                },

                {

                "featureType": "transit.station",

                "elementType": "geometry",

                "stylers": [

                    {

                    "color": "#eeeeee"

                    }

                ]

                },

                {

                "featureType": "water",

                "elementType": "geometry",

                "stylers": [

                    {

                    "color": "#c3d1c8"

                    }

                ]

                },

                {

                "featureType": "water",

                "elementType": "labels.text.fill",

                "stylers": [

                    {

                    "color": "#9e9e9e"

                    },

                    {

                    "visibility": "off"

                    }

                ]

                }

                ];
			var locations = []
            var addresses = []
			var geocoder = new google.maps.Geocoder;
			var service = new google.maps.DistanceMatrixService; 
			var bounds = new google.maps.LatLngBounds();

            
			function initMap() {
				map.setOptions({styles: styles});

                $.each($('.sucursales > div .loc'), function(){
                    var id = $(this).attr('id');
                    var cat = $(this).data('cat');
                    var title = $(this).find('.loc-link').text();
                    var dir = $(this).find('.loc-address').text();
                    var url = $(this).data('url');
                    var image = '/images/pin.png';
                    var imageSuc = '/images/pin-suc.png';
                    addresses.push(dir);
                    var infowindow = new google.maps.InfoWindow({});

                    geocoder.geocode({
                        'address': dir
                        }, function(results, status) {
                            if (status === 'OK') {

                            var lat = results[0].geometry.location.lat();
                            var lng = results[0].geometry.location.lng(); 
                            var loc = results[0].geometry.location;
                            locations.push({cat: cat, id: id, location: {lat: parseFloat(lat), lng: parseFloat(lng)} });

                            var markers = locations.forEach(function(location, i) {
                                    
                                if (locations[i].cat === "bar") {
                                    marker = new google.maps.Marker({
                                        map: map,
                                        icon: image,
                                        position: location.location,
                                        id: location.id
                                    });
                        
                                } else {
                                    marker = new google.maps.Marker({
                                        map: map,
                                        icon: imageSuc,
                                        position: location.location,
                                        id: location.id
                                    });
                                }

                                marker.addListener('click', function() {
                                    map.setZoom(12);
                                    
                                    map.setCenter(location.location);
                                    $(".sucursales").animate({
                                    scrollTop: $("#" + location.id).offset().top - 200
                                    }, 2000);

                                    $('.sucursales > div .loc').removeClass('active');
                                    $('.sucursales > div .loc' + "#" + location.id).addClass('active');
                                    
                                });

                                google.maps.event.addListener(marker, 'click', (function(marker, i) {

                                    var title = $('.sucursales > div .loc' + "#" + location.id).find('.loc-link').text();
                                    var dir = $('.sucursales > div .loc' + "#" + location.id).find('.loc-address').text();
                                    var url = $('.sucursales > div .loc' + "#" + location.id).data('url');
                                    return function() {
                                        infowindow.setContent('<div id="content"><h3>' + title + '</h3>' + '<p>' + dir + '</p>' + '<a class="h2" href="' + url + '"> Get directions </a>' + '</div>');
                                        infowindow.open(map, marker);
                                    }
                                })(marker, i));

                                // $('.sucursales > div .loc').click(function(){
                                //     var id = $(this).attr('id');
                                    
                                //     map.setZoom(12);
                                //     map.setCenter(new google.maps.LatLng(lat, lng));
                                    
                                //     $('.sucursales > div .loc').removeClass('active');
                                //     $(this).addClass('active');
                                // });


                                return marker;
                                // return infowindow;
                                

                            });

                            } else {
                                alert('Geocode was not successful for the following reason: ' + status);
                            }

                    });
                   

                })
                
				var bounds = new google.maps.LatLngBounds();
				
				for (var i = 0; i < location.length; i++) {
					bounds.extend(location[i].getPosition());
				}
                
                // console.log(locations);

                
            //  map.fitBounds(bounds);

			}

		initMap();
        

        // function definePopupClass() {
        //     Popup = function(e, t) {
        //         var o = document.createElement("DIV");
        //         this.position = e,
        //         o.classList.add("popup-bubble-content");
        //         var a = document.createElement("div");
        //         a.classList.add("popup-bubble-anchor"),
        //         this.anchor = document.createElement("div"),
        //         this.anchor.classList.add("popup-tip-anchor"),
        //         this.anchor.appendChild(a),
        //         this.stopEventPropagation()
        //     }
        //     ,
        //     Popup.prototype = Object.create(google.maps.OverlayView.prototype),
        //     Popup.prototype.onAdd = function() {
        //         this.getPanes().floatPane.appendChild(this.anchor)
        //     }
        //     ,
        //     Popup.prototype.onRemove = function() {
        //         this.anchor.parentElement && this.anchor.parentElement.removeChild(this.anchor)
        //     }
        //     ,
        //     Popup.prototype.draw = function() {
        //         var e = this.getProjection().fromLatLngToDivPixel(this.position)
        //         , t = Math.abs(e.x) < 4e3 && Math.abs(e.y) < 4e3 ? "block" : "none";
        //         "block" === t && (this.anchor.style.left = e.x + "px",
        //         this.anchor.style.top = e.y + "px"),
        //         this.anchor.style.display !== t && (this.anchor.style.display = t)
        //     }
        //     ,
        //     Popup.prototype.stopEventPropagation = function() {
        //         var e = this.anchor;
        //         e.style.cursor = "auto",
        //         ["click", "dblclick", "contextmenu", "wheel", "mousedown", "touchstart", "pointerdown"].forEach(function(t) {
        //             e.addEventListener(t, function(e) {
        //                 e.stopPropagation()
        //             })
        //         })
        //     }
        // }

	
	</script>
</body>

</html>