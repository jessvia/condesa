<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="stylesheet" type="text/css" href="css/style.css">
  <link rel="icon" href="favicon.png" type="image/x-icon" />

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="manifest" href="/images/site.webmanifest">

  <title>Project name - Page</title>
  <meta name="description" content="">
</head>

<body>
  <div class="loader-component">
    <div class="loader-image"></div>
  </div>

  <!--Modals-->
  <!--end-->

  <header class="header-night"></header>

  <main class="page mb-80 mb-md-100">
      <section>
          <div class="col-md-10 mx-auto">
              <h1>Hola, FIND me A CONDESA gin</h1>
              <form action="">
                <div class="input-group">
                    <input type="text" placeholder="Please enter state, city, or zip code">
                    <button></button>
                </div>
              </form>
          </div>
      </section>
  </main>

  <div id="svg"></div>

  <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
  
  <!-- JS libs -->
  
  <!-- start: interactions -->
  <script src="js/libs/swiper.min.js"></script>
  <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
  <script src="js/libs/basicScroll.js"></script>
  <script src="js/libs/tweenMax.min.js"></script>
  <!-- end: interactions -->
  
  <!-- main js -->
  <script src="js/app.js"></script>

  <script>
		var map = new google.maps.Map(document.getElementById('google-maps'), {
				zoom: 12,
				center: {lat: 19.4149803, lng: -99.1774462}
			});
			var styles = [
    {
        "featureType": "administrative",
        "elementType": "labels.text.fill",
        "stylers": [
            {
                "color": "#ababab"
            }
        ]
    },
    {
        "featureType": "landscape",
        "elementType": "all",
        "stylers": [
            {
                "color": "#ffffff"
            }
        ]
    },
    {
        "featureType": "poi",
        "elementType": "all",
        "stylers": [
            {
                "visibility": "off"
            }
        ]
    },
    {
        "featureType": "road",
        "elementType": "all",
        "stylers": [
            {
                "saturation": -100
            },
            {
                "lightness": "25"
            },
            {
                "color": "#f9f8f6"
            }
        ]
    },
    {
        "featureType": "road",
        "elementType": "labels.text",
        "stylers": [
            {
                "color": "#c0c0c0"
            },
            {
                "visibility": "simplified"
            }
        ]
    },
    {
        "featureType": "road",
        "elementType": "labels.icon",
        "stylers": [
            {
                "visibility": "off"
            }
        ]
    },
    {
        "featureType": "road.highway",
        "elementType": "all",
        "stylers": [
            {
                "visibility": "simplified"
            }
        ]
    },
    {
        "featureType": "road.highway",
        "elementType": "labels.icon",
        "stylers": [
            {
                "visibility": "off"
            }
        ]
    },
    {
        "featureType": "road.arterial",
        "elementType": "labels.icon",
        "stylers": [
            {
                "visibility": "off"
            }
        ]
    },
    {
        "featureType": "transit",
        "elementType": "all",
        "stylers": [
            {
                "visibility": "off"
            }
        ]
    },
    {
        "featureType": "water",
        "elementType": "all",
        "stylers": [
            {
                "color": "#bbf0ff"
            },
            {
                "visibility": "on"
            }
        ]
    }
];
			var locations = []

			var geocoder = new google.maps.Geocoder;
			var service = new google.maps.DistanceMatrixService;
			var bounds = new google.maps.LatLngBounds();
			function showAll(){
				if (navigator.geolocation) {
	        navigator.geolocation.getCurrentPosition(function(position) {
	          origin = {lat: position.coords.latitude, lng: position.coords.longitude};
	          
	          $.each($('.sucursales > div .loc'), function(){
              var id = $(this).attr('id');
               
							var destinationA = new google.maps.LatLng($(this).data('lat'), $(this).data('lng'));
							
							service.getDistanceMatrix({
			          origins: [origin],
			          destinations: [destinationA],
			          travelMode: 'DRIVING',
			          unitSystem: google.maps.UnitSystem.METRIC,
			          avoidHighways: false,
			          avoidTolls: false
			        }, function(response, status) {
			          if (status !== 'OK') {
	                $("#"+id+" .loc-links .loc-links-time small").text("no disponible");
	              } else {
	                if(response.rows[0].elements[0].distance){
	                  
	                  $("#"+id+" .loc-links .loc-links-time small").text(response.rows[0].elements[0].distance.text);
	                }else{
	                  $("#"+id+" .loc-links .loc-links-time small").text("no disponible");
	                }
	              }
			        })
			      });
	        })
	      }

				$.each($('.sucursales > div .loc'), function(){
					var id = $(this).attr('id');
					var lat = $(this).data('lat');
					var lng = $(this).data('lng');
					locations.push({id: id, location: {lat: parseFloat(lat), lng: parseFloat(lng)} });
					
				});

				var bounds = new google.maps.LatLngBounds();
				
				for (var i = 0; i < location.length; i++) {
					bounds.extend(location[i].getPosition());
				}
			}

			function initMap() {
				map.setOptions({styles: styles});
				image = '/assets/greengrass/ico/pin.png';

				showAll();

				var markers = locations.map(function(location, i) {
					marker = new google.maps.Marker({
						position: location.location,
						map: map,
						icon: image,
						id: location.id
					});

					marker.addListener('click', function() {
	          map.setZoom(17);

	          map.setCenter(location.location);
            $(".sucursales").animate({
              scrollTop: $("#" + location.id).offset().top - 200
						}, 2000);
						
						$('.sucursales > div .loc').removeClass('active');
						$('.sucursales > div .loc' + "#" + location.id).addClass('active');
	        });

	        $('.sucursales > div .loc').click(function(){
	          var id = $(this).attr('id');
	          var lat = $(this).data('lat');
	          var lng = $(this).data('lng');

	          map.setZoom(17);
						map.setCenter(new google.maps.LatLng(lat, lng));
						$('.sucursales > div .loc').removeClass('active');
						$(this).addClass('active');
	        });

					return marker;
				});
				for (var i=0; i<markers.length; i++) {
		          if(markers[i].getVisible()) {
		            bounds.extend( markers[i].getPosition() );
		          }
		    }
		    // map.fitBounds(bounds);
			}
		

		initMap();
	</script>
</body>

</html>